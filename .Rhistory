santykis_akciju=p2/p3
time=time[-1]
santykis_akciju=data.frame(time,santykis_akciju)
a=inner_join(portf,santykis_akciju,by="time")
a=a[,-1]
View(a)
b=apply(a[,-1],2,function(i)cor(a[,1],i))
plot(a[,2],a[,1])
View(a)
a=inner_join(portf,santykis_akciju,by="time")
plot(a[,2],a[,1])
a[,1]
View(a)
akc = melt(a[,c,2:10], id=c("time"))
akc = melt(a[,2:10], id=c("time"))
View(a)
akc = melt(a[,c("time","portfelis","AA")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
library("dplyr")
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
library("ggplot2")
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
View(a)
value
akc = melt(a[,c("time","portfelis","AA")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=time, y=porfelis, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","portfelis","AA")], id=c("time"))
ggplot(akc) + geom_line(aes(x=Data, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","portfelis","AA")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc
akc = melt(a[,c("time","portfelis","AA")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","portfelis","AA","AAPL")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
b=apply(a[,-1],2,function(i)a[,1]-i)
b=apply(a[,-1],2,function(i)a[,1]-i)
a[,2]-a[,3]
b=apply(a[,-1],2,function(i)a[,1]-i)
b=lapply(a[,-1],2,function(i)a[,1]-i)
b=sapply(a[,-1],2,function(i)a[,1]-i)
b=apply(a[,-1],2,function(i)c=a[,1]-i)
b=apply(a[,-1],2,function(i)a[1,1]-i[1])
apply(a[,-1],2,class)
b=apply(a[,-1],2,as.numeric)
b
View(b)
b=apply(a[,-1],2,function(i)a[,1]-i)
b=apply(b[,-1],2,function(i)b[,1]-i)
View(b)
b=apply(a[,-1],2,as.numeric)
b=apply(b[,-1],2,function(i)i-b[,1])
View(b)
cbind(a[,1],b)
c=data.frame(cbind(a[,1],b))
c
View(c)
akc = melt(c[,c("V1","AA","AAPL")], id=c("V1"))
akc
ggplot(akc) + geom_line(aes(x=V1, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=V1, y=value, colour=variable)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=V1, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
a=inner_join(portf,santykis_akciju,by="time")
b=apply(a[,-1],2,function(i)cor(a[,1],i))
a
View(a)
a[,-1]
a=a[,-1]
View(a)
a=apply(a[,-1],2,function(i)i-a[,1])
View(a)
a=inner_join(portf,santykis_akciju,by="time")
a=a[,-1]
b=apply(a[,-1],2,function(i)i-a[,1])
a=inner_join(portf,santykis_akciju,by="time")
c=data.frame(cbind(a[,1],b))
View(a)
akc = melt(c[,c("time","AA","AAPL")], id=c("time"))
View(c)
akc = melt(c[,c("time","AA","AAPL")], id=c("time"))
d=data.frame(cbind(a[,1],b))
akc = melt(d[,c("time","AA","AAPL")], id=c("time"))
View(d)
d=data.frame(cbind(a[,1],b))
akc = melt(d[,c("V1","AA","AAPL")], id=c("V1"))
ggplot(akc) + geom_line(aes(x=V1, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
a=inner_join(portf,santykis_akciju,by="time")
a=a[,-1]
b=apply(a[,-1],2,function(i)cor(a[,1],i))
d=data.frame (b[b<0])
c=data.frame(b)
colnames(c)=c("portfilis")
e=apply(a[,-1],2,function(i)cor.test(a[,1],i)$p.value)
View(d)
View(d)
a=inner_join(portf,santykis_akciju,by="time")
a=a[,-1]
b=apply(a[,-1],2,function(i)i-a[,1])
a=inner_join(portf,santykis_akciju,by="time")
d=data.frame(cbind(a[,1],b))
akc = melt(d[,c("V1","ALR")], id=c("V1"))
ggplot(akc) + geom_line(aes(x=V1, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
a=inner_join(portf,santykis_akciju,by="time")
akc = melt(a[,c("time","ALR")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","ALR","portfelis")], id=c("time"))
akc = melt(a[,c("time","ALR","portfelis")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
b=a[,-1]
b=apply(b[,-1],2,function(i)cor(b[,1],i))
c=data.frame (b[b<0])
colnames(c)=c("portfilis")
View(c)
View(c)
setDT(c, keep.rownames = TRUE)[]
View(c)
akc = melt(a[,c[1,]], id=c("time"))
akc = melt(a[,c[,1]], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value[1:5], colour=variable,group=1)) +
scale_colour_manual(values=c(1:5))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
View(akc)
akc = melt(a[,c[,1]], id=c("time"))
a[-1:2]
a[,-1:2]
a[,-(1:2)]
a[1,2]
View(d)
names(a)
names(a[,1])
names(a[,-1])
View(d)
apply(names(a[,-(1:2)]),2,function(i)which(i %in% names(d[,-1])))
apply(names(a[,-(1:2)]),function(i)which(i %in% names(d[,-1])))
sapply(names(a[,-(1:2)]),function(i)which(i %in% names(d[,-1])))
View(d)
View(c)
sapply(names(a[,-(1:2)]),function(i)which(i %in% names(c[,-2])))
g=sapply(names(a[,-(1:2)]),function(i)which(i %in% names(c[,-2])))
g
sum(g)
sum(as.numeric(g))
as.numeric(g)
g=lapply(names(a[,-(1:2)]),function(i)which(i %in% names(c[,-2])))
g
sum(as.numeric(g))
as.numeric(g)
g
a=inner_join(portf,santykis_akciju,by="time")
akc = melt(a[,], id=c("time"))
View(c)
akc = melt(a, id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value[c("portfilis","BBGI","ISSC")], colour=variable,group=1)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
View(a)
akc = melt(a[,c("portfilis","BBGI","ISSC","time")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value[c("portfilis","BBGI","ISSC")], colour=variable,group=1)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc
akc = melt(a[,c("portfilis","BBGI","ISSC","time")], id=c("time"))
View(a)
akc = melt(a[,c("portfilis","BBGI","ISSC","time")], id=c("time"))
akc = melt(a[,c("portfilis","BBGI","ISSC","time")], id=c("time"))
a[,c("portfilis","BBGI","ISSC","time")]
View(a)
a[,c("portfilis","BBGI","ISSC"]
a[,c("portfilis","BBGI","ISSC")]
akc = melt(d[,c("V1","ALR")], id=c("V1"))
akc = melt(a[,c("time","portfilis","BBGI","ISSC")], id=c("time"))
c
c=c("time","portfilis","BBGI","ISSC")
akc = melt(a[,c], id=c("time"))
c=c("time","portfilis","BBGI","ISSC")
c
c=c("time","portfilis","ISSC")
a[,c]
c=c("time","portfilis")
a[,c]
c=c("time")
a[,c]
c=c("time","portfilis")
a[,c]
View(a)
View(d)
b=a[,-1]
b=apply(b[,-1],2,function(i)cor(b[,1],i))
c=data.frame (b[b<0])
colnames(c)=c("portfilis")
View(c)
View(c)
akc = melt(a[,c("time","portfelis","JONE","ISSC")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value[c("portfilis","BBGI","ISSC")], colour=variable,group=1)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=time, y=value[c("portfilis","BBGI","ISSC")], colour=variable)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
ggplot(akc) + geom_line(aes(x=time, y=value[c("portfilis","BBGI","ISSC")], colour=variable,group=1)) +
scale_colour_manual(values=c(1:4))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
View(akc)
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1:3))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","portfelis")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","JONE")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(1))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
akc = melt(a[,c("time","portfelis")], id=c("time"))
ggplot(akc) + geom_line(aes(x=time, y=value, colour=variable,group=1)) +
scale_colour_manual(values=c(2))+ylab("% pokytis")+
guides(col=guide_legend(title="Kintamieji"))
View(a)
shapiro.test(a[,2])
shapiro.test(a[,3])
apply(a[,-1],2,function(i)shapiro.test(i)$p.value)
apply(a[,-1],2,function(i)shapiro.test(i)$p.value)>0.05
sum(apply(a[,-1],2,function(i)shapiro.test(i)$p.value)>0.05)
?cor
b=apply(b[,-1],2,function(i)cor(b[,1],i,method = "spearman"))
b=a[,-1]
b=apply(b[,-1],2,function(i)cor(b[,1],i,method = "spearman"))
c=data.frame (b[b<0])
View(c)
?cor.test
e=apply(a[,-1],2,function(i)cor.test(a[,1],i,method = "spearman")$p.value)
e=apply(b[,-1],2,function(i)cor.test(b[,1],i,method = "spearman")$p.value)
b=a[,-1]
e=apply(b[,-1],2,function(i)cor.test(b[,1],i,method = "spearman")$p.value)
e=data.frame(e[e>0.05])
View(e)
View(e)
View(c)
c %in% e
lapply(c,function(i)i %in% e)
lapply(names(c),function(i)i %in% names(e))
names(c)
lapply(names(c[,2]),function(i)i %in% names(e))
names(c[,2])
names(c[,-1])
View(c)
c[,1]
setDT(c, keep.rownames = TRUE)[]
c[,1]
View(c)
c[,1]
c
c[,1]
c[2,1]
View(c)
data.frame(c)
c=data.frame(c)
c[,1]
names(e)
e
e=data.frame(e)
e
e[,1]
setDT(e, keep.rownames = TRUE)[]
e=data.frame(e)
e[,1]
lapply(c[,1]),function(i)i %in% e[,1])
c[,1]
lapply(c[,1]),function(i)i %in% e[,1])
lapply(c[,1],function(i)i %in% e[,1])
matrix=c(1:9,byrows=T)
matrix(1:9,byrows=T)
matrix(1:9,byrow=T,ncol=3)
?dimnames
dimnames(a)=list(vertinimas=c("puikus","normalus","blogas"),gautas_balas=c("1-5","6-8","9-10"))
a=matrix(1:9,byrow=T,ncol=3)
dimnames(a)=list(vertinimas=c("puikus","normalus","blogas"),gautas_balas=c("1-5","6-8","9-10"))
a
chisq.test(a)
prop.test(tab)
tab <-matrix(c(189, 10845, 104, 10933), nrow=2, byrow=T)
colnames(tab) <- c("taip", "ne")
rownames(tab) <- c("Placebas", "Aspirinas")
prop.test(tab)
ipilta<-c("pienas","pienas","arbata","arbata")
speta<-c("pienas","arbata","pienas","arbata")
suskaiciuota<-c(3,1,1,3)
arbataduom<-data.frame(ipilta,speta,suskaiciuota)
arbataduom
arbata<-xtabs(suskaiciuota~ipilta+speta,data=arbataduom)
fisher.test(arbata,alternative="greater")
library(epiR)
tab <-matrix(c(189, 10845, 104, 10933), nrow=2, byrow=T)
colnames(tab) <- c("taip", "ne")
rownames(tab) <- c("Placebas", "Aspirinas")
epi.2by2(tab,method="cohort.count")
tab <-matrix(c(189, 10845, 104, 10933), nrow=2, byrow=T)
colnames(tab) <- c("taip", "ne")
rownames(tab) <- c("Placebas", "Aspirinas")
prop.test(tab)
SS <- matrix(c(189, 104, 10845, 10933), nrow = 2)
dimnames(SS) <- list("Group" = c("placebas","aspirinas"),
"SS" = c("taip","ne"))
prop.table(SS, margin = 1)
prop.test(SS)
prop.table(a, margin = 1)
a=matrix(1:9,byrow=T,ncol=3)
dimnames(a)=list(vertinimas=c("puikus","normalus","blogas"),gautas_balas=c("1-5","6-8","9-10"))
a
prop.table(a, margin = 1)
SS <- matrix(c(189, 104, 10845, 10933), nrow = 2)
dimnames(SS) <- list("Group" = c("placebas","aspirinas"),
"SS" = c("taip","ne"))
SS
prop.table(SS, margin = 1)
prop.test(SS)
a=matrix(1:9,byrow=T,ncol=3)
dimnames(a)=list(vertinimas=c("puikus","normalus","blogas"),gautas_balas=c("1-5","6-8","9-10"))
chisq.test(a)
?prop.table
SS <- matrix(c(189, 104, 10845, 10933), nrow = 2)
dimnames(SS) <- list("Group" = c("placebas","aspirinas"),
"SS" = c("taip","ne"))
prop.table(SS, margin = 1) #row wise jei 1
prop.test(SS)
prop.test(SS)
p.out <- prop.test(SS)
prop.table(SS, margin = 1) #row wise jei 1
prop.test(SS)
prop.table(SS, margin = 1) #row wise jei 1
prop.test(SS)
p.out <- prop.test(SS)
p.out$estimate[1]
p.out$estimate[2]
p.out$estimate[1] - p.out$estimate[2]
?confin
?confint
library("dplyr")
library("quantmod")
library(data.table)
library(Quandl)
library("ggplot2")
data=read.csv("WIKI_20161013.csv")
data=read.csv("WIKI_20161013.csv")
colnames(data)= c("Symbol","Date", "Open", "High", "Low", "Close", "Volume", "Ex-Dividend", "Split Ratio", "Adj. Open", "Adj. High", "Adj. Low", "Adj.Close", "Adj. Volume")
data=data %>% select(c(Symbol,Date,Adj.Close))
data$Date=as.Date(data$Date)
data2=subset(data, Date < as.Date("2016-01-01") &  Date >= as.Date("2015-01-01"))
View(data2)
write.csv(data2, file = "akciju_kainos2015.csv",row.names=FALSE)
istraukimas = function(symbol){
istraukimas = function(symbol){
newdata = data[data$Symbol==symbol,-1]
rownames(newdata) <- NULL
colnames(newdata)=c("Date",symbol)
return(newdata)
}
istraukimas2 = function(b){
a=seq(as.Date("2016-01-01"), as.Date("2017-01-01"), "day")
a=data.frame(a)
a[,1]=as.factor(a[,1])
colnames(a)="Date"
for (i in b){
b=istraukimas(i)
a=inner_join(a,b,by="Date")
}
return(a)
}
portfelis = function(akcijos,svoriai){
p=istraukimas2(akcijos)
time=p[,1]
p2=data.frame(apply(p[,-1],2,diff))
p3=p[,-1]
p3=p3[-nrow(p3),]
santykis=p2/p3
santykis= santykis + 1
portfelis = apply(santykis,1,function(i)svoriai*i)
portfelis = apply(portfelis,2,sum)
time=time[-1]
portfelis=data.frame(time,portfelis)
portfelis [,2]=as.numeric(portfelis [,2])
portfelis [,2]=portfelis [,-1]-1
return(portfelis)
}
data=read.csv("akcijos_geroje_lenteleje.csv")
rollmean(data,30,allign="left")
rollmean(data,30,allign="left")
?rollmean
datamean=rollmean(data, 30,allign="left", fill="left")
library(quantmod)
rollmean(data,30,allign="left")
a=rollmean(data[,-1],30,allign="left")
View(a)
b=mean(data[1:30,])
b=mean(data[1:30,-1])
data[1:30,-1]
class(data)
b=mean(data[1:30,-1])
class(data[2,2])
class(data[1,2])
class(data[1,1])
data[1,1]
class(data[1,2])
b=mean(data[1:30,-1])
data=data[,-1]
b=mean(data[1:30,])
View(data)
data=matrix(data)
View(data)
View(a)
mean(data[1:30,])
b=mean(data[1:30,])
b=mean(data[1:30,])
data=read.csv("akcijos_geroje_lenteleje.csv")
a=rollmean(data[,-1],30,allign="left")
b=mean(data[1:30,])
b=mean(data[1:30,-1])
b=mean(data[1:30,2])
View(data)
a=rollmean(data[,-1],30,allign="left")
View(a)
b=mean(data[1:30,2])
View(a)
b=mean(data[1:30,3])
View(data)
View(a)
?rollapply
rollapply(a, width = 30, FUN = sd, align = "left")
b=rollapply(data, width = 30, FUN = sd, align = "left")
View(b)
View(a)
sd(data[2,1:30])
View(b)
View(b)
sd(data[2,2:31])
View(b)
b=rollapply(data, width = 30, FUN = mean, align = "left")
b=rollapply(data[,-1], width = 30, FUN = mean, align = "left")
View(b)
View(a)
View(b)
View(a)
a==b
b=rollapply(data[,-1], width = 30, FUN = sd, align = "left")
View(b)
View(b)
data[2,1:30]
sd(data[1:30,2])
View(b)
a=rollapply(data[,-1], width = 30, FUN = mean, align = "left")
b=rollapply(data[,-1], width = 30, FUN = sd, align = "left")
newdata=data[-c(1:30),]
View(newdata)
View(b)
View(newdata)
View(data)
View(b)
View(a)
View(b)
newdata=data[-c(1:29),]
View(newdata)
rowname(newdata)=NULL
rowname(newdata)=NA
rownames(newdata)=NULL
View(newdata)
View(data)
?mutate
library("dplyr")
>mutate
?mutate
mutate(data,naujas=NA)
